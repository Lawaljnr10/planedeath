<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mousekoin Miner</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #miner, #adminPanel { display: none; margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
    button { padding: 10px 15px; margin: 5px 0; }
    #walletInfo { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Mousekoin Miner</h1>
  <button id="connectWalletBtn">Connect Wallet</button>
  <div id="walletInfo"></div>

  <div id="miner">
    <h2>Miner Interface</h2>
    <p>Mined MSK: <span id="minedAmount">0</span> MSK</p>
    <p>Time Remaining: <span id="timeRemaining">10:00</span></p>
    <button id="startMiningBtn">Start Mining</button>
    <button id="withdrawBtn" disabled>Withdraw Mined MSK</button>
  </div>

  <div id="adminPanel">
    <h2>Admin Panel</h2>
    <p>Welcome, Admin! You can perform administrative tasks here.</p>
    <!-- Additional admin functionalities can be added here -->
  </div>

  <script>
    // Set the admin wallet address (in lowercase for comparison)
    const adminAddress = "0xde45f6a59a96daa0ae7f26bad254aa88241b8d04";
    let userAccount = "";
    let miningInterval;
    let minedAmount = 0;
    const ratePerSecond = 0.000000000138; // MSK mined per second
    const miningDuration = 10 * 60; // 10 minutes in seconds

    // Connect wallet button event
    document.getElementById('connectWalletBtn').addEventListener('click', async function() {
      if (window.ethereum) {
        try {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          userAccount = accounts[0];
          document.getElementById('walletInfo').innerText = "Connected account: " + userAccount;
          // Show miner interface once connected
          document.getElementById('miner').style.display = "block";
          // If the connected account is the admin, show the admin panel
          if (userAccount.toLowerCase() === adminAddress) {
            document.getElementById('adminPanel').style.display = "block";
          }
        } catch (error) {
          console.error(error);
          alert("Wallet connection failed!");
        }
      } else {
        alert("Please install Trust Wallet or a compatible wallet provider.");
      }
    });

    // Start mining button event
    document.getElementById('startMiningBtn').addEventListener('click', function() {
      // Disable start button to prevent multiple clicks
      this.disabled = true;
      minedAmount = 0;
      let secondsPassed = 0;

      // Update the mined amount and timer display every second
      miningInterval = setInterval(() => {
        secondsPassed++;
        minedAmount += ratePerSecond;
        document.getElementById('minedAmount').innerText = minedAmount.toFixed(12);

        // Calculate remaining time
        let remaining = miningDuration - secondsPassed;
        let minutes = Math.floor(remaining / 60);
        let seconds = remaining % 60;
        document.getElementById('timeRemaining').innerText =
          (minutes < 10 ? "0" + minutes : minutes) + ":" + (seconds < 10 ? "0" + seconds : seconds);

        // When the 10-minute period is over, stop mining and enable withdrawal
        if (secondsPassed >= miningDuration) {
          clearInterval(miningInterval);
          document.getElementById('withdrawBtn').disabled = false;
          document.getElementById('startMiningBtn').innerText = "Mining Completed";
        }
      }, 1000);
    });

    // Withdraw button event
    document.getElementById('withdrawBtn').addEventListener('click', function() {
      // Simulate withdrawal by showing an alert
      alert("Withdrawing " + minedAmount.toFixed(12) + " MSK to your wallet: " + userAccount);
      // Reset for potential new mining session
      minedAmount = 0;
      document.getElementById('minedAmount').innerText = "0";
      this.disabled = true;
      // Optionally, reset the start button for another session
      document.getElementById('startMiningBtn').disabled = false;
      document.getElementById('startMiningBtn').innerText = "Start Mining";
      document.getElementById('timeRemaining').innerText = "10:00";
    });
  </script>
</body>
</html>
